â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         BENCHMARK æ¨¡å‹è¨“ç·´è¨ˆåŠƒï¼ˆä¿®æ­£ç‰ˆï¼‰                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… å‰µå»ºæ™‚é–“: 2025-11-18
âš ï¸  é‡è¦ä¿®æ­£: METAGENE å¿…é ˆä½¿ç”¨ BPE tokenizer

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Š è¨“ç·´ç›®æ¨™ï¼ˆä¿®æ­£ç‰ˆï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
è¨“ç·´ 3 å€‹ä¸åŒæ¶æ§‹çš„æ¨¡å‹é€²è¡Œæ€§èƒ½æ¯”è¼ƒï¼š

1. âœ… METAGENE-1 + BPE Tokenizer (Baseline)
   - Tokenizer: BPE (METAGENE å°ˆç”¨)
   - Encoder: METAGENE-1 (~100M parameters)
   - é…ç½®: metaclassifier/configs/metagene_bpe.yaml
   - Max length: 192
   - é è¨ˆè¨“ç·´æ™‚é–“: ~3-4 å°æ™‚

2. âœ… DNABERT-2 + K-mer Tokenizer
   - Tokenizer: 6-mer with overlap
   - Encoder: DNABERT-2 (~117M parameters)
   - é…ç½®: metaclassifier/configs/dnabert_kmer.yaml
   - Max length: 512
   - é è¨ˆè¨“ç·´æ™‚é–“: ~3-4 å°æ™‚

3. âœ… Evo2 + Single-nucleotide Tokenizer
   - Tokenizer: Single-nucleotide (A=4, C=5, G=6, T=7)
   - Encoder: Evo2 7B (~7B parameters) âš ï¸ éœ€è¦å¤§é‡ GPU è¨˜æ†¶é«”
   - é…ç½®: metaclassifier/configs/evo2_nucleotide.yaml
   - Max length: 8192 (supports up to 1M)
   - é è¨ˆè¨“ç·´æ™‚é–“: ~6-8 å°æ™‚ (è¼ƒå¤§æ¨¡å‹)

ç¸½é è¨ˆè¨“ç·´æ™‚é–“: ~12-16 å°æ™‚

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âŒ éŒ¯èª¤é…ç½®ï¼ˆä¸è¦ä½¿ç”¨ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Ã— METAGENE + K-mer  â† ä¸ç›¸å®¹ï¼METAGENE åªèƒ½ç”¨ BPE
  åŸå› : METAGENE-1 çš„ tokenizer æ˜¯å°ˆé–€è¨“ç·´çš„ BPE

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸš€ å¿«é€Ÿé–‹å§‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. æ¿€æ´»ç’°å¢ƒä¸¦è¨­ç½®ç’°å¢ƒè®Šé‡:
   
   source /home/user/anaconda3/bin/activate METAGENE
   export HF_HOME=/media/user/disk2/.cache/huggingface
   export TRANSFORMERS_CACHE=/media/user/disk2/.cache/huggingface
   export PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True,max_split_size_mb:128
   cd /media/user/disk2/METAGENE/classification

2. é‹è¡Œè¨“ç·´è…³æœ¬ï¼ˆä¿®æ­£ç‰ˆï¼‰:
   
   ./train_benchmark_models_correct.sh

   æˆ–è€…åœ¨èƒŒæ™¯é‹è¡Œ:
   
   nohup ./train_benchmark_models_correct.sh > train_benchmark.log 2>&1 &
   
   ç›£æ§é€²åº¦:
   tail -f train_benchmark.log

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âš ï¸  é‡è¦æ³¨æ„äº‹é …
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Evo2 è¨˜æ†¶é«”éœ€æ±‚:
   - Evo2 7B æ¨¡å‹éå¸¸å¤§ (~28GB æ¨¡å‹æ¬Šé‡)
   - å»ºè­°ä½¿ç”¨ A100 40GB æˆ–æ›´å¤§çš„ GPU
   - å¦‚æœ GPU è¨˜æ†¶é«”ä¸è¶³ï¼Œå¯ä»¥è·³é Evo2ï¼Œåªè¨“ç·´å‰å…©å€‹æ¨¡å‹

2. å¦‚æœæƒ³è·³é Evo2:
   å¯ä»¥æ‰‹å‹•åªè¨“ç·´å‰å…©å€‹æ¨¡å‹ï¼Œåƒè¦‹ä¸‹æ–¹ã€Œæ‰‹å‹•è¨“ç·´ã€éƒ¨åˆ†

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“ æ‰‹å‹•è¨“ç·´ï¼ˆé¸æ“‡æ€§ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

æ¨¡å‹ 1: METAGENE + BPE âœ…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
python metaclassifier/train.py \
  --config metaclassifier/configs/metagene_bpe.yaml \
  --train_fasta /media/user/disk2/full_labeled_species_train_reads_shuffled \
  --val_fasta /media/user/disk2/full_labeled_species_val_reads_shuffled \
  --mapping_tsv /media/user/disk2/MetaTransformer_new_pipeline/myScript/all_available_species_mapping.tab \
  --output_dir outputs/my_metagene_bpe

æ¨¡å‹ 2: DNABERT + K-mer âœ…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
python metaclassifier/train.py \
  --config metaclassifier/configs/dnabert_kmer.yaml \
  --train_fasta /media/user/disk2/full_labeled_species_train_reads_shuffled \
  --val_fasta /media/user/disk2/full_labeled_species_val_reads_shuffled \
  --mapping_tsv /media/user/disk2/MetaTransformer_new_pipeline/myScript/all_available_species_mapping.tab \
  --output_dir outputs/my_dnabert_kmer

æ¨¡å‹ 3: Evo2 + Single-nucleotide âœ…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
python metaclassifier/train.py \
  --config metaclassifier/configs/evo2_nucleotide.yaml \
  --train_fasta /media/user/disk2/full_labeled_species_train_reads_shuffled \
  --val_fasta /media/user/disk2/full_labeled_species_val_reads_shuffled \
  --mapping_tsv /media/user/disk2/MetaTransformer_new_pipeline/myScript/all_available_species_mapping.tab \
  --output_dir outputs/my_evo2

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“ˆ æ¶æ§‹å°æ¯”
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

| æ¨¡å‹ | Tokenizer | Encoder Size | Max Length | è¨˜æ†¶é«”éœ€æ±‚ |
|------|-----------|--------------|------------|------------|
| METAGENE | BPE | ~100M | 192 | ~8GB |
| DNABERT | 6-mer | ~117M | 512 | ~10GB |
| Evo2 | Nucleotide | ~7B | 8192 | ~30GB+ |

æ¯”è¼ƒé‡é»:
- METAGENE: ä½¿ç”¨å­¸ç¿’çš„ BPEï¼Œæ•ˆç‡é«˜
- DNABERT: K-mer æ–¹æ³•ï¼Œå¯è§£é‡‹æ€§å¥½
- Evo2: æœ€ç´°ç²’åº¦ï¼ˆå–®æ ¸è‹·é…¸ï¼‰ï¼Œæœ€å¤§æ¨¡å‹ï¼Œç†è«–ä¸Šæœ€å¼·

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… å·²å®Œæˆçš„æ­¥é©Ÿ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ… æ¸¬è©¦æ•¸æ“šé›†å·²å‰µå»º
   - test_data/test_small.fa (2,380 sequences, 100 species)
   - test_data/test_medium.fa (22,433 sequences, 500 species)

2. âœ… è¨“ç·´è…³æœ¬å·²å‰µå»ºï¼ˆä¿®æ­£ç‰ˆï¼‰
   - train_benchmark_models_correct.sh

3. â³ å¾…å®Œæˆ: è¨“ç·´ 3 å€‹æ¨¡å‹

4. â³ å¾…å®Œæˆ: é‹è¡Œ benchmark è©•ä¼°

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ’¡ å»ºè­°çš„è¨“ç·´ç­–ç•¥
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

é¸é … A: å®Œæ•´æ¯”è¼ƒï¼ˆå¦‚æœæœ‰è¶³å¤  GPU è¨˜æ†¶é«”ï¼‰
  â†’ è¨“ç·´æ‰€æœ‰ 3 å€‹æ¨¡å‹ï¼ˆMETAGENE + DNABERT + Evo2ï¼‰

é¸é … B: æ¨™æº–æ¯”è¼ƒï¼ˆæ¨è–¦ï¼‰
  â†’ åªè¨“ç·´ METAGENE + DNABERTï¼ˆè·³é Evo2ï¼‰
  â†’ ä¿®æ”¹è…³æœ¬ç§»é™¤ Evo2 éƒ¨åˆ†

é¸é … C: å¿«é€Ÿé©—è­‰
  â†’ åªè¨“ç·´ METAGENEï¼ˆbaselineï¼‰
  â†’ ä½¿ç”¨ç¾æœ‰æ¨¡å‹é€²è¡Œæ¯”è¼ƒ

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“š åƒè€ƒæ–‡æª”
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

- metaclassifier/README.md - å®Œæ•´æ¶æ§‹èªªæ˜
- metaclassifier/ARCHITECTURE.md - è¨­è¨ˆåŸç†
- metaclassifier/configs/*.yaml - å„é…ç½®æ–‡ä»¶è©³ç´°èªªæ˜
- metaclassifier/USING_EVO2.md - Evo2 ä½¿ç”¨æŒ‡å—

