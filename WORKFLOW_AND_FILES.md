# è¨“ç·´èˆ‡æ¸¬è©¦å·¥ä½œæµç¨‹èˆ‡æª”æ¡ˆé—œä¿‚

## ğŸ“Š å®Œæ•´å·¥ä½œæµç¨‹åœ–

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      æº–å‚™æ•¸æ“šé›†                    â”‚
                    â”‚  â€¢ train.fa                      â”‚
                    â”‚  â€¢ val.fa                        â”‚
                    â”‚  â€¢ mapping.tsv                   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      é–‹å§‹è¨“ç·´                      â”‚
                    â”‚  python train.py                 â”‚
                    â”‚    --config ...                  â”‚
                    â”‚    --train_fasta ...             â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                          â”‚
                    â–¼                          â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  åˆå§‹åŒ–éšæ®µ       â”‚      â”‚  ä¿å­˜é…ç½®             â”‚
         â”‚  â€¢ åŠ è¼‰æ•¸æ“š       â”‚      â”‚  ğŸ“„ config.json       â”‚
         â”‚  â€¢ å‰µå»ºæ¨¡å‹       â”‚      â”‚  ğŸ“„ *_distribution.csvâ”‚
         â”‚  â€¢ è¨­ç½®å„ªåŒ–å™¨     â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚           è¨“ç·´å¾ªç’° (10 epochs)        â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚  â”‚  æ¯å€‹ Epoch:                  â”‚   â”‚
         â”‚  â”‚  1. è¨“ç·´éšæ®µ (1M steps)       â”‚   â”‚
         â”‚  â”‚     â†’ è¨˜éŒ„ loss, lr           â”‚â”€â”€â”€â”¼â”€â”€â†’ ğŸ“„ training.log
         â”‚  â”‚     â†’ æ¯10æ­¥æ¸…ç†GPUè¨˜æ†¶é«”      â”‚   â”‚
         â”‚  â”‚                               â”‚   â”‚
         â”‚  â”‚  2. é©—è­‰éšæ®µ (250K samples)   â”‚   â”‚
         â”‚  â”‚     â†’ è¨ˆç®— accuracy, F1       â”‚   â”‚
         â”‚  â”‚     â†’ ç”Ÿæˆæ··æ·†çŸ©é™£             â”‚   â”‚
         â”‚  â”‚                               â”‚   â”‚
         â”‚  â”‚  3. ä¿å­˜æª¢æŸ¥é»                 â”‚   â”‚
         â”‚  â”‚     â†’ å¦‚æœæ˜¯æœ€ä½³æ¨¡å‹ â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â†’ ğŸ’¾ checkpoints/best.pt
         â”‚  â”‚     â†’ ä¿å­˜æœ€å¾Œæ¨¡å‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â†’ ğŸ’¾ checkpoints/last.pt
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚        è¨“ç·´å®Œæˆè™•ç†                    â”‚
         â”‚  1. ä¿å­˜æœ€çµ‚æ¨¡å‹è³‡è¨Š                   â”‚â”€â”€â†’ ğŸ“ final_model/
         â”‚     â€¢ label2id.json                  â”‚      â€¢ label2id.json
         â”‚     â€¢ id2label.json                  â”‚      â€¢ id2label.json
         â”‚     â€¢ seen_classes.txt               â”‚      â€¢ seen_classes.txt
         â”‚                                      â”‚
         â”‚  2. ç”Ÿæˆå¯è¦–åŒ–åœ–è¡¨                     â”‚â”€â”€â†’ ğŸ“ plots/
         â”‚     â€¢ training_curves.png            â”‚      â€¢ training_curves.png
         â”‚     â€¢ confusion_matrix.png           â”‚      â€¢ confusion_matrix.png
         â”‚                                      â”‚
         â”‚  3. ä¿å­˜æœ€çµ‚æŒ‡æ¨™                       â”‚â”€â”€â†’ ğŸ“„ final_metrics.json
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚        ä½¿ç”¨è¨“ç·´å¥½çš„æ¨¡å‹                 â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                 â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  è©•ä¼°æ¨¡å¼        â”‚   â”‚  é æ¸¬æ¨¡å¼                â”‚
       â”‚  (evaluate.py)  â”‚   â”‚  (predict.py)           â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                 â”‚
                â–¼                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  è©•ä¼°è¼¸å‡ºæª”æ¡ˆ      â”‚   â”‚  é æ¸¬è¼¸å‡ºæª”æ¡ˆ            â”‚
    â”‚  ğŸ“„ test_metrics.json                â”‚   â”‚  ğŸ“„ predictions.csv      â”‚
    â”‚  ğŸ“„ test_classification_report.json  â”‚   â”‚  (sequence_id,          â”‚
    â”‚  ğŸ“„ test_per_class_metrics.csv       â”‚   â”‚   predicted_label,      â”‚
    â”‚  ğŸ“„ test_predictions.csv             â”‚   â”‚   confidence)           â”‚
    â”‚  ğŸ“Š test_confusion_matrix.png        â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ æª”æ¡ˆç”Ÿæˆæ™‚é–“ç·š

### éšæ®µ 1: è¨“ç·´é–‹å§‹ (0 åˆ†é˜)
```
outputs/subset_training_20251107_122024/
â”œâ”€â”€ config.json                     âœ… ç«‹å³ç”Ÿæˆ
â”œâ”€â”€ train_class_distribution.csv    âœ… ç«‹å³ç”Ÿæˆ
â””â”€â”€ val_class_distribution.csv      âœ… ç«‹å³ç”Ÿæˆ
```

### éšæ®µ 2: è¨“ç·´é€²è¡Œä¸­ (0-48 å°æ™‚ï¼Œæ¯å€‹ epoch ~47å°æ™‚)
```
outputs/subset_training_20251107_122024/
â”œâ”€â”€ training.log                    ğŸ”„ æŒçºŒæ›´æ–°ï¼ˆæ¯ 5 æ­¥è¨˜éŒ„ä¸€æ¬¡ï¼‰
â””â”€â”€ checkpoints/
    â””â”€â”€ best.pt                     ğŸ”„ æ¯å€‹ epoch å¾Œæ›´æ–°ï¼ˆå¦‚æœæ˜¯æœ€ä½³ï¼‰
```

**æ—¥èªŒæ›´æ–°é »ç‡**ï¼š
- è¨“ç·´ lossï¼šæ¯ 5 å€‹ step è¨˜éŒ„ä¸€æ¬¡
- GPU è¨˜æ†¶é«”ï¼šæ¯ 10 å€‹ step è¨˜éŒ„ä¸€æ¬¡
- é©—è­‰æŒ‡æ¨™ï¼šæ¯å€‹ epoch çµæŸå¾Œè¨˜éŒ„

**æª¢æŸ¥é»ä¿å­˜æ™‚æ©Ÿ**ï¼š
- æ¯å€‹ epoch é©—è­‰å®Œæˆå¾Œ
- åªæœ‰ç•¶é©—è­‰ macro F1-score æé«˜æ™‚æ‰æ›´æ–° `best.pt`

### éšæ®µ 3: è¨“ç·´å®Œæˆ (ç¬¬ 10 å€‹ epoch çµæŸå¾Œ)
```
outputs/subset_training_20251107_122024/
â”œâ”€â”€ final_model/                    âœ… è¨“ç·´çµæŸæ™‚ç”Ÿæˆ
â”‚   â”œâ”€â”€ label2id.json
â”‚   â”œâ”€â”€ id2label.json
â”‚   â””â”€â”€ seen_classes.txt
â”œâ”€â”€ plots/                          âœ… è¨“ç·´çµæŸæ™‚ç”Ÿæˆ
â”‚   â””â”€â”€ training_curves.png
â””â”€â”€ final_metrics.json              âœ… è¨“ç·´çµæŸæ™‚ç”Ÿæˆ
```

### éšæ®µ 4: è©•ä¼°/æ¸¬è©¦ (æ‰‹å‹•è§¸ç™¼)
```bash
python evaluate.py --ckpt checkpoints/best.pt --split test
```

```
outputs/my_evaluation/
â”œâ”€â”€ test_metrics.json               âœ… è©•ä¼°å®Œæˆæ™‚ç”Ÿæˆ
â”œâ”€â”€ test_classification_report.json âœ… è©•ä¼°å®Œæˆæ™‚ç”Ÿæˆ
â”œâ”€â”€ test_per_class_metrics.csv      âœ… è©•ä¼°å®Œæˆæ™‚ç”Ÿæˆ
â”œâ”€â”€ test_predictions.csv            âœ… è©•ä¼°å®Œæˆæ™‚ç”Ÿæˆ
â””â”€â”€ test_confusion_matrix.png       âœ… è©•ä¼°å®Œæˆæ™‚ç”Ÿæˆ
```

---

## ğŸ“‹ æª”æ¡ˆä¾è³´é—œä¿‚åœ–

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   åŸå§‹æ•¸æ“š       â”‚
                    â”‚  â€¢ train.fa     â”‚
                    â”‚  â€¢ val.fa       â”‚
                    â”‚  â€¢ mapping.tsv  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  config.json    â”‚ â† è¨“ç·´é…ç½®çš„æºé ­
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                 â”‚
                    â–¼                                 â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  training.log    â”‚            â”‚  checkpoints/    â”‚
          â”‚  (è¨“ç·´éç¨‹è¨˜éŒ„)   â”‚            â”‚  best.pt         â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚                        â”‚                    â”‚
                          â–¼                        â–¼                    â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  final_model/    â”‚    â”‚  plots/          â”‚  â”‚ final_metrics. â”‚
                â”‚  â€¢ label2id.json â”‚â†â”€â”€â”€â”¤  â€¢ training_     â”‚  â”‚ json           â”‚
                â”‚  â€¢ id2label.json â”‚    â”‚    curves.png    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚  â€¢ seen_classes  â”‚    â”‚  â€¢ confusion_    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    matrix.png    â”‚
                         â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                         â”‚
                         (ç”¨æ–¼æ¨ç†å’Œè©•ä¼°) â”‚
                                         â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                      â”‚
                    â–¼                                      â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  evaluate.py         â”‚            â”‚  predict.py        â”‚
          â”‚  (æ¸¬è©¦é›†è©•ä¼°)         â”‚            â”‚  (æ–°æ•¸æ“šé æ¸¬)       â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                                  â”‚
                     â–¼                                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  è©•ä¼°è¼¸å‡º             â”‚            â”‚  predictions.csv   â”‚
          â”‚  â€¢ test_metrics.json â”‚            â”‚  (é æ¸¬çµæœ)        â”‚
          â”‚  â€¢ test_predictions  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚    .csv              â”‚
          â”‚  â€¢ test_confusion_   â”‚
          â”‚    matrix.png        â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ é—œéµæª”æ¡ˆçš„ç”¨é€”çŸ©é™£

| æª”æ¡ˆ | è¨“ç·´æ™‚ä½¿ç”¨ | æ¢å¾©è¨“ç·´ | è©•ä¼°/æ¸¬è©¦ | é æ¸¬ | çµæœåˆ†æ |
|------|-----------|----------|-----------|------|---------|
| `config.json` | âœ… | âœ… | âš ï¸ (åƒè€ƒ) | âš ï¸ (åƒè€ƒ) | âœ… |
| `training.log` | âœ… | âœ… | âŒ | âŒ | âœ… |
| `checkpoints/best.pt` | âœ… | âœ… | âœ… | âœ… | âŒ |
| `label2id.json` | âš ï¸ (è‡ªå‹•ç”Ÿæˆ) | âŒ | âœ… | âœ… | âœ… |
| `id2label.json` | âš ï¸ (è‡ªå‹•ç”Ÿæˆ) | âŒ | âœ… | âœ… | âœ… |
| `training_curves.png` | âš ï¸ (è¨“ç·´å¾Œ) | âŒ | âŒ | âŒ | âœ… |
| `final_metrics.json` | âš ï¸ (è¨“ç·´å¾Œ) | âŒ | âŒ | âŒ | âœ… |
| `test_predictions.csv` | âŒ | âŒ | âš ï¸ (è¼¸å‡º) | âš ï¸ (è¼¸å‡º) | âœ… |

**åœ–ä¾‹**ï¼š
- âœ… å¿…éœ€/ç¶“å¸¸ä½¿ç”¨
- âš ï¸ å¯é¸/è‡ªå‹•ç”Ÿæˆ
- âŒ ä¸ç›¸é—œ

---

## ğŸ’¾ æª”æ¡ˆè®€å¯«æ“ä½œè©³è§£

### è¨“ç·´éšæ®µ

#### è®€å–çš„æª”æ¡ˆï¼š
1. **é…ç½®æª”æ¡ˆ** (`configs/rtx4090_optimized.yaml`)
   - è®€å–æ™‚æ©Ÿï¼šè¨“ç·´é–‹å§‹å‰
   - è®€å–æ–¹å¼ï¼šä¸€æ¬¡æ€§è®€å–ï¼Œè§£æç‚ºå­—å…¸

2. **è¨“ç·´æ•¸æ“š** (`train.fa`, `val.fa`)
   - è®€å–æ™‚æ©Ÿï¼šæ¯å€‹ epoch é–‹å§‹
   - è®€å–æ–¹å¼ï¼šæµå¼è®€å–ï¼ˆé€æ‰¹æ¬¡åŠ è¼‰åˆ°è¨˜æ†¶é«”ï¼‰

3. **æ˜ å°„æª”æ¡ˆ** (`mapping.tsv`)
   - è®€å–æ™‚æ©Ÿï¼šè¨“ç·´é–‹å§‹å‰
   - è®€å–æ–¹å¼ï¼šä¸€æ¬¡æ€§è®€å–ï¼Œå»ºç«‹ class_id â†’ label_name æ˜ å°„

#### å¯«å…¥çš„æª”æ¡ˆï¼š
1. **config.json**
   - å¯«å…¥æ™‚æ©Ÿï¼šè¨“ç·´é–‹å§‹å‰ï¼ˆç¬¬ 0 ç§’ï¼‰
   - å¯«å…¥å…§å®¹ï¼šå®Œæ•´çš„è¨“ç·´é…ç½®ï¼ˆå¾ YAML å’Œ CLI åƒæ•¸åˆä½µï¼‰
   - å¯«å…¥æ–¹å¼ï¼šä¸€æ¬¡æ€§å¯«å…¥

2. **training.log**
   - å¯«å…¥æ™‚æ©Ÿï¼šè¨“ç·´å…¨ç¨‹ï¼ˆæ¯ 5 å€‹ stepï¼‰
   - å¯«å…¥å…§å®¹ï¼š
     ```
     [12:20:30] INFO Starting training...
     Training: 1%|â–| 14/1000000 [00:05<47:00, 5.8it/s, loss=0.85, lr=1.97e-04]
     [12:25:30] INFO GPU Memory - Allocated: 13.24GB
     ```
   - å¯«å…¥æ–¹å¼ï¼šè¿½åŠ æ¨¡å¼ï¼ˆappendï¼‰

3. **checkpoints/best.pt**
   - å¯«å…¥æ™‚æ©Ÿï¼šæ¯å€‹ epoch é©—è­‰å®Œæˆå¾Œï¼ˆå¦‚æœæ˜¯æœ€ä½³æ¨¡å‹ï¼‰
   - å¯«å…¥å…§å®¹ï¼š
     ```python
     {
         'model_state_dict': model.state_dict(),
         'optimizer_state_dict': optimizer.state_dict(),
         'scheduler_state_dict': scheduler.state_dict(),
         'epoch': epoch,
         'step': global_step,
         'metrics': val_metrics
     }
     ```
   - å¯«å…¥æ–¹å¼ï¼šè¦†è“‹æ¨¡å¼ï¼ˆoverwriteï¼‰

4. **final_model/** ç›®éŒ„
   - å¯«å…¥æ™‚æ©Ÿï¼šæ‰€æœ‰ epoch å®Œæˆå¾Œ
   - å¯«å…¥å…§å®¹ï¼š
     - `label2id.json`: `{"Escherichia coli": 0, ...}`
     - `id2label.json`: `{"0": "Escherichia coli", ...}`
     - `seen_classes.txt`: `0\n1\n2\n...`

5. **plots/training_curves.png**
   - å¯«å…¥æ™‚æ©Ÿï¼šæ‰€æœ‰ epoch å®Œæˆå¾Œ
   - ç”Ÿæˆæ–¹å¼ï¼šä½¿ç”¨ matplotlib å¾è¨“ç·´æ­·å²æ•¸æ“šç¹ªè£½

---

### è©•ä¼°éšæ®µ

#### è®€å–çš„æª”æ¡ˆï¼š
1. **checkpoints/best.pt**
   - è®€å–æ™‚æ©Ÿï¼šè©•ä¼°é–‹å§‹å‰
   - è®€å–æ–¹å¼ï¼š`torch.load()`

2. **æ¸¬è©¦æ•¸æ“š** (`test.fa`)
   - è®€å–æ™‚æ©Ÿï¼šè©•ä¼°éç¨‹ä¸­
   - è®€å–æ–¹å¼ï¼šæ‰¹æ¬¡è®€å–

3. **mapping.tsv** + **id2label.json**
   - è®€å–æ™‚æ©Ÿï¼šçµæœè¼¸å‡ºæ™‚
   - ç”¨é€”ï¼šå°‡é æ¸¬çš„ class_id è½‰æ›ç‚º label_name

#### å¯«å…¥çš„æª”æ¡ˆï¼š
1. **test_metrics.json**
   - å…§å®¹ï¼šæ•´é«”æŒ‡æ¨™ï¼ˆaccuracy, F1, etc.ï¼‰
   - ç”Ÿæˆæ–¹å¼ï¼šå¾æ‰€æœ‰é æ¸¬çµæœè¨ˆç®—èšåˆæŒ‡æ¨™

2. **test_predictions.csv**
   - å…§å®¹ï¼šæ¯å€‹æ¨£æœ¬çš„é æ¸¬çµæœ
   - æ ¼å¼ï¼š
     ```csv
     sequence_id,true_label,predicted_label,confidence,correct
     seq_001,E.coli,E.coli,0.98,True
     ```
   - å¯«å…¥æ–¹å¼ï¼šé€è¡Œå¯«å…¥ï¼ˆstreamingï¼‰æˆ–æ‰¹æ¬¡å¯«å…¥

3. **test_classification_report.json**
   - å…§å®¹ï¼šæ¯å€‹é¡åˆ¥çš„ precision, recall, F1
   - ç”Ÿæˆæ–¹å¼ï¼šä½¿ç”¨ `sklearn.metrics.classification_report`

4. **test_per_class_metrics.csv**
   - å…§å®¹ï¼šèˆ‡ classification_report ç›¸åŒï¼Œä½†ä»¥ CSV æ ¼å¼
   - ç”¨é€”ï¼šä¾¿æ–¼ç”¨ Excel/Pandas åˆ†æ

5. **test_confusion_matrix.png**
   - å…§å®¹ï¼šæ··æ·†çŸ©é™£çš„ç†±åŠ›åœ–
   - ç”Ÿæˆæ–¹å¼ï¼šä½¿ç”¨ seaborn/matplotlib å¾æ··æ·†çŸ©é™£ç¹ªè£½

---

## ğŸ” æª”æ¡ˆæª¢æŸ¥æ¸…å–®

### âœ… è¨“ç·´æˆåŠŸçš„æ¨™èªŒï¼š

```bash
# 1. æª¢æŸ¥ config.json æ˜¯å¦å­˜åœ¨
[ -f outputs/my_experiment/config.json ] && echo "âœ“ Config saved"

# 2. æª¢æŸ¥æœ€ä½³æ¨¡å‹æ˜¯å¦ä¿å­˜
[ -f outputs/my_experiment/checkpoints/best.pt ] && echo "âœ“ Best model saved"

# 3. æª¢æŸ¥è¨“ç·´æ˜¯å¦å®Œæˆï¼ˆå­˜åœ¨ final_model/ï¼‰
[ -d outputs/my_experiment/final_model ] && echo "âœ“ Training completed"

# 4. æª¢æŸ¥è¨“ç·´æ›²ç·šæ˜¯å¦ç”Ÿæˆ
[ -f outputs/my_experiment/plots/training_curves.png ] && echo "âœ“ Plots generated"

# 5. æŸ¥çœ‹æœ€çµ‚æŒ‡æ¨™
cat outputs/my_experiment/final_metrics.json | jq '.macro_f1'
```

### âš ï¸ è¨“ç·´ä¸­æ–·çš„æª¢æŸ¥ï¼š

```bash
# 1. æª¢æŸ¥ training.log çš„æœ€å¾Œå¹¾è¡Œ
tail -20 outputs/my_experiment/training.log

# 2. æª¢æŸ¥æ˜¯å¦æœ‰ CUDA OOM éŒ¯èª¤
grep "out of memory" outputs/my_experiment/training.log

# 3. æª¢æŸ¥é€²ç¨‹æ˜¯å¦é‚„åœ¨é‹è¡Œ
ps aux | grep train.py

# 4. æª¢æŸ¥ last.pt æ˜¯å¦å­˜åœ¨ï¼ˆç”¨æ–¼æ¢å¾©è¨“ç·´ï¼‰
[ -f outputs/my_experiment/checkpoints/last.pt ] && echo "âœ“ Can resume training"
```

---

## ğŸ“¦ å®Œæ•´ç¤ºä¾‹ï¼šå¾è¨“ç·´åˆ°è©•ä¼°

### æ­¥é©Ÿ 1: è¨“ç·´æ¨¡å‹

```bash
# å•Ÿå‹•è¨“ç·´
python train.py \
  --config configs/rtx4090_optimized.yaml \
  --train_fasta data/train.fa \
  --val_fasta data/val.fa \
  --mapping_tsv data/mapping.tsv \
  --output_dir outputs/my_species_classifier \
  --max_epochs 10

# é æœŸè¼¸å‡ºæª”æ¡ˆï¼ˆè¨“ç·´å®Œæˆå¾Œï¼‰ï¼š
# outputs/my_species_classifier/
# â”œâ”€â”€ config.json                     âœ…
# â”œâ”€â”€ training.log                    âœ…
# â”œâ”€â”€ train_class_distribution.csv    âœ…
# â”œâ”€â”€ val_class_distribution.csv      âœ…
# â”œâ”€â”€ checkpoints/
# â”‚   â””â”€â”€ best.pt                     âœ…
# â”œâ”€â”€ final_model/
# â”‚   â”œâ”€â”€ label2id.json               âœ…
# â”‚   â”œâ”€â”€ id2label.json               âœ…
# â”‚   â””â”€â”€ seen_classes.txt            âœ…
# â”œâ”€â”€ plots/
# â”‚   â””â”€â”€ training_curves.png         âœ…
# â””â”€â”€ final_metrics.json              âœ…
```

### æ­¥é©Ÿ 2: è©•ä¼°æ¨¡å‹

```bash
# åœ¨æ¸¬è©¦é›†ä¸Šè©•ä¼°
python evaluate.py \
  --ckpt outputs/my_species_classifier/checkpoints/best.pt \
  --split test \
  --output_dir outputs/test_evaluation

# é æœŸè¼¸å‡ºæª”æ¡ˆï¼š
# outputs/test_evaluation/
# â”œâ”€â”€ test_metrics.json               âœ…
# â”œâ”€â”€ test_classification_report.json âœ…
# â”œâ”€â”€ test_per_class_metrics.csv      âœ…
# â”œâ”€â”€ test_predictions.csv            âœ…
# â””â”€â”€ test_confusion_matrix.png       âœ…
```

### æ­¥é©Ÿ 3: åˆ†æçµæœ

```bash
# 1. æŸ¥çœ‹æ•´é«”æ€§èƒ½
cat outputs/test_evaluation/test_metrics.json | jq '{
  accuracy: .accuracy,
  macro_f1: .macro_f1,
  num_samples: .num_samples
}'

# 2. æ‰¾å‡ºè¡¨ç¾æœ€å·®çš„ 10 å€‹é¡åˆ¥
cat outputs/test_evaluation/test_per_class_metrics.csv | \
  sort -t',' -k5 -n | head -10

# 3. åˆ†æéŒ¯èª¤æ¨£æœ¬
grep ",False$" outputs/test_evaluation/test_predictions.csv | \
  head -20

# 4. æŸ¥çœ‹æ··æ·†çŸ©é™£
display outputs/test_evaluation/test_confusion_matrix.png
```

---

## ğŸ”— ç›¸é—œæ–‡æª”

- [OUTPUT_FILES_GUIDE.md](OUTPUT_FILES_GUIDE.md) - å®Œæ•´çš„æª”æ¡ˆèªªæ˜æ–‡æª”
- [OUTPUT_STRUCTURE_SUMMARY.txt](OUTPUT_STRUCTURE_SUMMARY.txt) - ç°¡æ˜çµæ§‹ç¸½çµ
- [README.md](README.md) - é …ç›®ä¸»æ–‡æª”

---

**æœ€å¾Œæ›´æ–°**ï¼š2025-11-09  
**ç‰ˆæœ¬**ï¼š1.0

