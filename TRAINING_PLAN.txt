â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘            BENCHMARK æ¨¡å‹è¨“ç·´è¨ˆåŠƒ                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… å‰µå»ºæ™‚é–“: 2025-11-18

ğŸ“Š è¨“ç·´ç›®æ¨™
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
è¨“ç·´ 3 å€‹ä¸åŒé…ç½®çš„æ¨¡å‹é€²è¡Œæ€§èƒ½æ¯”è¼ƒï¼š

1. METAGENE-1 + BPE Tokenizer (Baseline)
   - ä½¿ç”¨åŸå§‹çš„ BPE tokenizer
   - é…ç½®: configs/fast_training.yaml
   - é è¨ˆè¨“ç·´æ™‚é–“: ~3-4 å°æ™‚

2. METAGENE-1 + K-mer Tokenizer
   - ä½¿ç”¨ 6-mer tokenization
   - é…ç½®: metaclassifier/configs/metagene_kmer.yaml
   - é è¨ˆè¨“ç·´æ™‚é–“: ~3-4 å°æ™‚

3. DNABERT-2 + K-mer Tokenizer
   - ä½¿ç”¨ä¸åŒçš„ encoder
   - é…ç½®: metaclassifier/configs/dnabert_kmer.yaml
   - é è¨ˆè¨“ç·´æ™‚é–“: ~3-4 å°æ™‚

ç¸½é è¨ˆè¨“ç·´æ™‚é–“: ~9-12 å°æ™‚

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸš€ å¿«é€Ÿé–‹å§‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. æ¿€æ´»ç’°å¢ƒä¸¦è¨­ç½®ç’°å¢ƒè®Šé‡:
   
   source /home/user/anaconda3/bin/activate METAGENE
   export HF_HOME=/media/user/disk2/.cache/huggingface
   export TRANSFORMERS_CACHE=/media/user/disk2/.cache/huggingface
   export PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True,max_split_size_mb:128
   cd /media/user/disk2/METAGENE/classification

2. é‹è¡Œè¨“ç·´è…³æœ¬ï¼ˆè‡ªå‹•è¨“ç·´æ‰€æœ‰ 3 å€‹æ¨¡å‹ï¼‰:
   
   ./train_benchmark_models.sh

   æˆ–è€…åœ¨èƒŒæ™¯é‹è¡Œ:
   
   nohup ./train_benchmark_models.sh > train_benchmark.log 2>&1 &
   
   ç›£æ§é€²åº¦:
   tail -f train_benchmark.log

3. è¨“ç·´å®Œæˆå¾Œï¼Œé‹è¡Œ benchmark:
   
   # è…³æœ¬æœƒè‡ªå‹•é¡¯ç¤ºå¦‚ä½•é‹è¡Œ benchmark çš„å‘½ä»¤

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“ æ‰‹å‹•è¨“ç·´ï¼ˆå¦‚æœéœ€è¦å–®ç¨è¨“ç·´æŸå€‹æ¨¡å‹ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

æ¨¡å‹ 1: METAGENE + BPE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
python train.py \
  --train_set_path /media/user/disk2/full_labeled_species_train_reads_shuffled \
  --validation_set_path /media/user/disk2/full_labeled_species_val_reads_shuffled \
  --mapping_df /media/user/disk2/MetaTransformer_new_pipeline/myScript/all_available_species_mapping.tab \
  --output_dir outputs/my_metagene_bpe \
  --config configs/fast_training.yaml

æ¨¡å‹ 2: METAGENE + K-mer
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
python metaclassifier/train.py \
  --config metaclassifier/configs/metagene_kmer.yaml \
  --train_fasta /media/user/disk2/full_labeled_species_train_reads_shuffled \
  --val_fasta /media/user/disk2/full_labeled_species_val_reads_shuffled \
  --mapping_tsv /media/user/disk2/MetaTransformer_new_pipeline/myScript/all_available_species_mapping.tab \
  --output_dir outputs/my_metagene_kmer

æ¨¡å‹ 3: DNABERT + K-mer
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
python metaclassifier/train.py \
  --config metaclassifier/configs/dnabert_kmer.yaml \
  --train_fasta /media/user/disk2/full_labeled_species_train_reads_shuffled \
  --val_fasta /media/user/disk2/full_labeled_species_val_reads_shuffled \
  --mapping_tsv /media/user/disk2/MetaTransformer_new_pipeline/myScript/all_available_species_mapping.tab \
  --output_dir outputs/my_dnabert_kmer

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“ˆ è¨“ç·´é…ç½®è©³æƒ…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

æ‰€æœ‰æ¨¡å‹å…±åŒè¨­ç½®:
- Max epochs: 3-5
- Batch size: 1 (with gradient accumulation)
- Precision: bf16-mixed
- Early stopping: 2 epochs patience
- LoRA: enabled (r=4, alpha=8)

å·®ç•°:
- Tokenizer: BPE vs K-mer (k=6)
- Encoder: METAGENE-1 vs DNABERT-2
- Max length: 128 (BPE) vs 512 (K-mer)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… å·²å®Œæˆçš„æ­¥é©Ÿ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ… æ¸¬è©¦æ•¸æ“šé›†å·²å‰µå»º
   - test_data/test_small.fa (2,380 sequences, 100 species)
   - test_data/test_medium.fa (22,433 sequences, 500 species)

2. âœ… è¨“ç·´è…³æœ¬å·²å‰µå»º
   - train_benchmark_models.sh

3. â³ å¾…å®Œæˆ: è¨“ç·´ 3 å€‹æ¨¡å‹

4. â³ å¾…å®Œæˆ: é‹è¡Œ benchmark è©•ä¼°

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ’¡ æç¤º
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. è¨“ç·´æœŸé–“å¯ä»¥ä½¿ç”¨ nvidia-smi ç›£æ§ GPU ä½¿ç”¨æƒ…æ³
2. æ¯å€‹æ¨¡å‹æœƒè‡ªå‹•ä¿å­˜æœ€ä½³ checkpoint åˆ°å„è‡ªçš„ outputs/ ç›®éŒ„
3. è¨“ç·´æ—¥èªŒæœƒè‡ªå‹•ä¿å­˜åœ¨å„å€‹è¼¸å‡ºç›®éŒ„ä¸­
4. å¦‚æœè¨“ç·´ä¸­æ–·ï¼Œå¯ä»¥å¾æœ€å¾Œçš„ checkpoint æ¢å¾©
5. å»ºè­°åœ¨è¨“ç·´å‰ç¢ºä¿ç¡¬ç¢Ÿç©ºé–“è¶³å¤ ï¼ˆæ¯å€‹æ¨¡å‹ ~13GBï¼‰

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“ éœ€è¦å¹«åŠ©?
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

æŸ¥çœ‹ç›¸é—œæ–‡æª”:
- BENCHMARK_README.md - Benchmark ç³»çµ±èªªæ˜
- æ€§èƒ½æ¯”è¼ƒæµç¨‹.md - å®Œæ•´è©•ä¼°æµç¨‹
- metaclassifier/configs/ - å„é…ç½®æ–‡ä»¶è©³ç´°èªªæ˜

